{###############################################################################

Expected context variables:

- `code` -> a WRAPPED `ecczoogen.code.Code` object, with relations field
            populated (i.e., it must have been added to a
            `ecczoogen.code_collection.CodeCollection` which was subsequently
            finalized with its `finished()` method.)

################################################################################}

<dl class="ecc-code ecc-code-page info-popup-button-zone" id="ecc_{{code.code_id}}">

<!--<dt></dt>-->
<dd class="info-popup-button-container"></dd>

<dt class="code-name">Name</dt>
<dd class="code-name">
  <span class="code-name-cell">
  <span class="code-name">{{code.name}}</span>
  {%- if code.introduced -%}
    <span class="code-introduced">{{code.introduced}}</span>
  {%- endif -%}
  </span>
  <!--<a class="code-info-corner-icon code-self-permalink"
   title="permanent link to this code (click and then copy the location in the address bar)"
   href="{{code|code_ref_href}}">&nbsp;</a>-->
</dd>


<dt class="code-description">Description</dt>
<dd class="code-description">{{code.description}}</dd>

{% if code.protection %}
<dt class="code-protection">Protection</dt>
<dd class="code-protection">{{code.protection}}</dd>
{% endif %}


<!-- Display features -->


{# helper macro to display features #}

{% macro disp_feature_field(featurename, label) -%}
  {%- if code.features[featurename] -%}
  <dt class="code-feature code-feature-{{featurename}}">{{label}}</dt>
  <dd class="code-feature code-feature-{{featurename}}">
    {{- code.features[featurename] -}}
  </dd>
  {% endif %}
{%- endmacro %}


{{ disp_feature_field('rate', 'Rate') }}

{{ disp_feature_field('magic_scaling_exponent', 'Magic') }}

{{ disp_feature_field('encoders', 'Encoder') }}

{{ disp_feature_field('transversal_gates', 'Transversal Gates') }} {# note NON-BREAKING SPACE #}

{{ disp_feature_field('general_gates', 'Gates') }}

{{ disp_feature_field('decoders', 'Decoder') }}

{{ disp_feature_field('fault_tolerance', 'Fault Tolerance') }}

{{ disp_feature_field('code_capacity_threshold', 'Code Capacity Threshold') }}

{{ disp_feature_field('threshold', 'Threshold') }}


{% if code.realizations %}
<dt class="code-realizations">Realizations</dt>
<dd class="code-realizations">
  {{code.realizations}}
</dd>
{% endif %}

{% if code.notes %}
<dt class="code-notes">Notes</dt>
<dd class="code-notes">
  {{code.notes}}
</dd>
{% endif %}


<!-- Relationships to other codes -->

{% if code.relations.parents %}
<dt class="code-parents">Parent(s)</dt>
<dd class="code-parents">
  {% set use_relation_type = 'parents' %}
  {% set use_relations = code.relations.parents %}
  {% include 'pieces/list_code_relations.html' %}
</dd>
{% endif %}

{% if code.relations.parent_of %}
<dt class="code-parent-of">Parent of</dt>
<dd class="code-parent-of">
  {% set use_relation_type = 'parent-of' %}
  {% set use_relations = code.relations.parent_of %}
  {% include 'pieces/list_code_relations.html' %}
</dd>
{% endif %}

{% if code.relations.cousins or code.relations.cousin_of %}
<dt class="code-cousins">Cousin(s)</dt>
<dd class="code-cousins">
  {% set use_relation_type = 'cousins' %}
  {% set use_relations = [] + code.relations.cousins|list + code.relations.cousin_of|list %}
  {% include 'pieces/list_code_relations.html' %}
</dd>
{% endif %}


<!-- zoo-related information and how to edit -->

<dt class="display-code-id dt-wrap-label redundant-if-info-popup-button-installed">
  {# Error correction #}
  Zoo code information
</dt>
<dd class="display-code-id redundant-if-info-popup-button-installed">
  <div>
    <span class="display-code-id-label">Internal code ID:</span>
    {{code.code_id}}
  </div>{#
#}<div class="code-popup-info-frame"
       data-is-code-info-popup="1"
       data-popup-button-label="edit"
       data-popup-button-class-list="code-self-edit">{#
    #}<h2>Your contribution is welcome!</h2>{#
    #}<p><a class="code-link-with-icon code-show-github"
       target="_blank"
       title="Edit code information directly on github.com"
       href="https://github.com/errorcorrectionzoo/eczoo_data/tree/main/codes/{{code.source_info_filename}}">on github.com (edit &amp; pull request)</a></p>{#
    #}<p><a class="code-link-with-icon code-self-edit"
       target="_blank"
       title="edit code information on this site without using github"
       href="{{ ('edit_code?code_id='+code.code_id) | prebaseurl }}">edit on this site</a></p>{#
    #}<p class="zoo-code-id">Zoo Code ID: <code>{{code.code_id}}</code>{#
  #}</div>{#
#}<div class="code-popup-info-frame"
     data-is-code-info-popup="1"
     data-popup-button-label="cite"
     data-popup-button-class-list="code-show-citation">
  <dl class="show-citation">
    <dt>Cite as:</dt>
    <dd>“{{code.name|raw_minilatex_code}}”, The Error Correction Zoo (V. V. Albert & P. Faist, eds.), {{code.citation_info.year}}. https://errorcorrectionzoo.org{{code|code_ref_href}}</dd>
    <dt>BibTeX:</dt>
    <dd class="bibtex">{#
#}@incollection{{ '{' }}eczoo_{{code.code_id}},
title={{'{'}}{{ code.name|raw_minilatex_code }}{{'}'}},
booktitle={The Error Correction Zoo},
year={{'{'}}{{code.citation_info.year}}{{'}'}},
editor={Albert, Victor V. and Faist, Philippe},
url={{'{'}}https://errorcorrectionzoo.org{{code|code_ref_href}}{{'}'}}
{{ '}' }}{#
  #}</dd>
    <dt>Permanent link:</dt>
    <dd>https://errorcorrectionzoo.org{{code|code_ref_href}}</dd>
  </dl>
</div>
</dd>

</dl>
